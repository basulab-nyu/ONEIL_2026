#pragma rtGlobals=1macro save_tables_KO_old()// save Igor file in correct place before using or this will not work psave_tables_KO_old()killstrings/a/zkillvariables/a/zkillpath/a/zproc psave_tables_KO_old(str_input)string str_inputprompt str_input "input waves ?"pathinfo homestring/g str_path = s_pathnewpath/o/q str_symbpath, str_pathstring/g str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")string/g str_groupsvariable/g var_index = 0do	variable/g var_cut = strsearch(stringfromlist(var_index,str_list),"_",0)	string/g str_sub = stringfromlist(var_index,str_list)[0,var_cut]+"*"	if (itemsinlist(listmatch(str_groups,str_sub)) == 0)		if (strlen(str_groups) == 0)			str_groups = str_sub		else			str_groups = str_groups+";"+str_sub		endif	endif	var_index+=1while (var_index<itemsinlist(str_list))variable/g var_groups = 0do	string/g str_sublist = sortlist(wavelist(stringfromlist(var_groups,str_groups),";",""),";",16)	string/g str_folder	splitstring/e="([^[:punct:]]+)" getdatafolder(0),str_folder	string/g str_name = stringfromlist(var_groups,str_groups)[0,strlen(stringfromlist(var_groups,str_groups))-2]+str_folder+"_"+igorinfo(1)	variable/g var_index = 0	do		string/g str_wave = stringfromlist(var_index,str_sublist)		if (var_index == 0)			edit/n=$str_name $str_wave.ld		else			appendtotable/w=$str_name $str_wave.d		endif		var_index+=1	while (var_index < itemsinlist(str_sublist))	savetablecopy/p=str_symbpath/o/w=$str_name/t=2 as str_name+".csv"	killwindow/z $str_name	var_groups+=1while (var_groups<itemsinlist(str_groups))