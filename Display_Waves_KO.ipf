#pragma rtGlobals=1Macro Display_Waves_KO()pDWKO()proc pDWKO(str_input,str_batch,str_folder,str_output)string str_inputprompt str_input "input waves ?"string str_batchprompt str_batch "batch size ?"string str_folderprompt str_folder "output folder ?"string str_outputprompt str_output "output waves ?"if(itemsinlist(sortlist(winlist("*",";","WIN:1"),";",16)) == 0)	display	movewindow 458.25,43.25,852,251endifif(itemsinlist(sortlist(winlist("*",";","WIN:2"),";",16)) == 0)	edit	movewindow 353.25,278,858,485endifif(strlen(str_batch) == 0)	string/g str_list = sortlist(wavelist(str_input,";",""),";",16)	print replacestring(";",str_list,"\r")	variable/g var_index = 0	string/g str_graph_list = sortlist(winlist("*",";","WIN:1"),";",16)	string/g str_table_list = sortlist(winlist("*",";","WIN:2"),";",16)	variable/g var_graph_last = itemsinlist(str_graph_list)-1	string/g str_graph_last = winname(0,1)	variable/g var_table_last = itemsinlist(str_table_list)-1	string/g str_table_last = winname(0,2)	getwindow $str_graph_last, wsize	variable/g var_left_g = v_left + 5.25	variable/g var_top_g = v_top + 22.5	variable/g var_right_g = v_right + 5.25	variable/g var_bottom_g = v_bottom + 22.5	getwindow $str_table_last, wsize	variable/g var_left_t = v_left + 5.25	variable/g var_top_t = v_top + 22.5	variable/g var_right_t = v_right + 5.25	variable/g var_bottom_t = v_bottom + 22.5	variable/g var_total = itemsinlist(str_list)	silent 1	pauseupdate	display	if(strlen(str_output)==0)		do				appendtograph $stringfromlist(var_index,str_list)			if (strlen(str_folder)!=0)				if (datafolderexists(str_folder)==1)					movewave $stringfromlist(var_index,str_list), root:$(str_folder):				else					newdataFolder $str_folder					movewave $stringfromlist(var_index,str_list), root:$(str_folder):				endif			endif			var_index += 1		while(var_index<itemsinlist(str_list))	else		do				duplicate $stringfromlist(var_index,str_list) $(stringfromlist(var_index,str_list)+"_"+str_output)			appendtograph $(stringfromlist(var_index,str_list)+"_"+str_output)			killwaves/z $stringfromlist(var_index,str_list)			if (strlen(str_folder)!=0)				if (datafolderexists(str_folder)==1)					movewave $(stringfromlist(var_index,str_list)+"_"+str_output), root:$(str_folder):				else					newdataFolder $str_folder					movewave $(stringfromlist(var_index,str_list)+"_"+str_output), root:$(str_folder):				endif			endif			var_index += 1		while(var_index<itemsinlist(str_list))	endif	ModifyGraph rgb=(0,0,0)	resumeupdate	movewindow var_left_g,var_top_g,var_right_g,var_bottom_gelse	variable/g var_batch = str2num(str_batch)	variable/g var_catch = str2num(str_input[strsearch(str_input,"*",0)-3,strsearch(str_input,"*",0)-1])	variable/g var_loop = 0	do		string/g str_catch = str_input[0,strsearch(str_input,"*",0)-3]		str_catch = str_catch+num2str(var_catch+var_loop)+"*"		string/g str_list = sortlist(wavelist(str_catch,";",""),";",16)		print replacestring(";",str_list,"\r")		variable/g var_index = 0		string/g str_graph_list = sortlist(winlist("*",";","WIN:1"),";",16)		string/g str_table_list = sortlist(winlist("*",";","WIN:2"),";",16)		variable/g var_graph_last = itemsinlist(str_graph_list)-1		string/g str_graph_last = winname(0,1)		variable/g var_table_last = itemsinlist(str_table_list)-1		string/g str_table_last = winname(0,2)		getwindow $str_graph_last, wsize		variable/g var_left_g = v_left + 5.25		variable/g var_top_g = v_top + 22.5		variable/g var_right_g = v_right + 5.25		variable/g var_bottom_g = v_bottom + 22.5		getwindow $str_table_last, wsize		variable/g var_left_t = v_left + 5.25		variable/g var_top_t = v_top + 22.5		variable/g var_right_t = v_right + 5.25		variable/g var_bottom_t = v_bottom + 22.5		variable/g var_total = itemsinlist(str_list)		silent 1		pauseupdate		display		if(strlen(str_output)==0)			do					appendtograph $stringfromlist(var_index,str_list)				if (strlen(str_folder)!=0)					if (datafolderexists(str_folder)==1)						movewave $stringfromlist(var_index,str_list), root:$(str_folder):					else						newdataFolder $str_folder						movewave $stringfromlist(var_index,str_list), root:$(str_folder):					endif				endif				var_index += 1			while(var_index<itemsinlist(str_list))		else			do					duplicate $stringfromlist(var_index,str_list) $(stringfromlist(var_index,str_list)+"_"+str_output)				appendtograph $(stringfromlist(var_index,str_list)+"_"+str_output)				killwaves/z $stringfromlist(var_index,str_list)				if (strlen(str_folder)!=0)					if (datafolderexists(str_folder)==1)						movewave $(stringfromlist(var_index,str_list)+"_"+str_output), root:$(str_folder):					else						newdataFolder $str_folder						movewave $(stringfromlist(var_index,str_list)+"_"+str_output), root:$(str_folder):					endif				endif				var_index += 1			while(var_index<itemsinlist(str_list))		endif		ModifyGraph rgb=(0,0,0)		resumeupdate		movewindow var_left_g,var_top_g,var_right_g,var_bottom_g		var_loop+=1	while(var_loop<var_batch)endif//endpGraphDKO()proc pGraphDKO()	Showinfo	showtools		ControlBar 56	button button2 proc=pbaselineD,title="baseline", size={60,20}, pos={60, 23}	//ModifyGraph height=300, width=700		string w 	w=stringfromlist(1, TraceNameList("",";",0))	cursor   A,$w,806.2	cursor B, $w,400	//ModifyGraph width=0,height=0Proc pbaselineDKO(ctrlName) 	String ctrlName	string tracename	variable index=0 	string list = TraceNameList("",";",1)  	variable vTotal=ItemsInList(list)  	//make/n=(vTotal) /o $output  	silent 1  	pauseupdate  do	  tracename=StringFromList(index, list)		if (strlen(traceName) == 0)			break					endif 		 		wavestats /q/r=(xcsr(A),xcsr(B)) $tracename 		 		$tracename = $tracename - V_avg 	  	  	 	 index=index+1while (1) Execute/P/Q/Z "INSERTINCLUDE <Waves Average>";Execute/P/Q/Z "COMPILEPROCEDURES ";Execute/P/Q/Z "MakeWavesAveragePanel()"SetAxis/Aresumeupdateend